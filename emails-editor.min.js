"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}var EmailsEditorApp=function(){function e(t){_classCallCheck(this,e),this.container=t,this.innerBoxEl={},this.emailAddEl={},this.emailListProxy=[],this.isSubscribe=!1,this.init()}return _createClass(e,[{key:"init",value:function(){this.container.innerHTML=this.emailsEditorBody(),this.setupEmailsEditor()}},{key:"emailsEditorBody",value:function(){return'<div class="emailsEditor"><div class="emailsEditor__body"><h3 class="emailsEditor__heading">Share <span class="emailsEditor__headingBold">Board name</span> with others</h3><div class="emailsEditor__innerBox"><span class="email email--add"><input class="email__input" type="text" placeholder="add more people..." spellcheck="false"></span></div></div><div class="emailsEditor__footer"><div class="emailsEditor__footerButtonWrapper"><button class="emailsEditor__footerButton emailsEditor__footerButton--add" type="button">Add email</button><button class="emailsEditor__footerButton emailsEditor__footerButton--count" type="button">Get emails count</button></div></div></div>'}},{key:"setupEmailsEditor",value:function(){var e=this,t=this.container.querySelector(".emailsEditor__footerButton--add"),i=this.container.querySelector(".emailsEditor__footerButton--count"),n=this.container.querySelector(".email--add .email__input");this.innerBoxEl=this.container.querySelector(".emailsEditor__innerBox"),this.emailAddEl=this.container.querySelector(".email--add"),i.addEventListener("click",function(){return alert(e.container.querySelectorAll(".email:not(.email--invalid)").length-1)}),t.addEventListener("click",function(){return e.addRandomEmail()}),n.addEventListener("keyup",function(t){13!==t.keyCode?188!==t.keyCode&&32!==t.keyCode||e.addEmail(t,!0):e.addEmail(t)}),n.addEventListener("focusout",function(t){e.addEmail(t)}),n.addEventListener("paste",function(t){t.preventDefault(),t.clipboardData.getData("text").split(/[ ,]+/).forEach(function(i){e.addEmail(t,!1,i.trim())})})}},{key:"getEmailList",value:function(){var e=this.container.querySelectorAll(".email:not(.email--add):not(.email--invalid) .email__input"),t=[];return Array.from(e).forEach(function(e){return t.push(e.value)}),t}},{key:"setEmailList",value:function(e){var t=this;"string"==typeof e?e.split(",").forEach(function(e){return t.addEmail(null,!1,e.trim())}):console.error("Please provide a string of comma separated emails")}},{key:"subscribe",value:function(){this.emailListProxy=new Proxy([],{set:function(e,t,i){return e[t]=i,console.log("Email list changed"),!0}}),this.isSubscribe=!0}},{key:"randomEmail",value:function(){return"".concat(Math.floor(26*Math.random())).concat(Math.random().toString(36).substring(2,11),"@random.com")}},{key:"emailElement",value:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;"},i=function(e){return t[e]||e},n=function(e){return e.replace(/[&<>]/g,i)};return'<span class="email__content">'.concat(n(e),'</span><span class="email__delete"><svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M8 0.8L7.2 0L4 3.2L0.8 0L0 0.8L3.2 4L0 7.2L0.8 8L4 4.8L7.2 8L8 7.2L4.8 4L8 0.8Z" fill="#050038" /></svg></span><input class="email__input" type="text" value="').concat(n(e),'" spellcheck="false">')}},{key:"removeEmail",value:function(e){e.currentTarget.parentElement.remove(),this.isSubscribe&&this.emailListProxy.splice(this.emailListProxy.indexOf(e.currentTarget.nextElementSibling.value),1)}},{key:"editEmail",value:function(e){var t=this,i=function(e){if(!e.target.value)return t.removeEmail(e),void t.emailAddEl.querySelector(".email__input").focus();e.target.parentElement.querySelector(".email__content").innerHTML=e.target.value,e.target.parentElement.classList.remove("email--edit"),t.emailAddEl.querySelector(".email__input").focus(),t.checkEmailIsValid(e.target.value)?e.target.parentElement.classList.remove("email--invalid"):e.target.parentElement.classList.add("email--invalid")};e.target.parentElement.classList.add("email--edit"),e.target.addEventListener("focusout",function(e){i(e)}),e.target.addEventListener("keyup",function(e){13===e.keyCode?i(e):e.target.parentElement.querySelector(".email__content").innerHTML=e.target.value})}},{key:"getClickHandler",value:function(e,t){var i=null;return function(n){i?(i=clearTimeout(i),t(n)):i=setTimeout(function(){e(n),i=null},250)}}},{key:"addRandomEmail",value:function(){var e=this,t=document.createElement("span");t.classList.add("email");var i=this.randomEmail();t.innerHTML=this.emailElement(i),t.querySelector(".email__input").addEventListener("click",this.getClickHandler(function(t){return e.editEmail(t)},function(){return null})),t.querySelector(".email__delete").addEventListener("click",function(t){return e.removeEmail(t)}),this.innerBoxEl.insertBefore(t,this.emailAddEl),this.isSubscribe&&this.emailListProxy.push(i)}},{key:"checkEmailIsValid",value:function(e){return/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/.test(e)}},{key:"addEmail",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",a=n||(e?e.target.value:"");if(a&&a.replace(/\s/g,"").length){var l=document.createElement("span");l.classList.add("email");var r="";!i||(r=a.slice(0,-1)).replace(/\s/g,"").length?(this.checkEmailIsValid(r||a)||l.classList.add("email--invalid"),l.innerHTML=this.emailElement(r||a),l.querySelector(".email__input").addEventListener("click",function(e){return t.editEmail(e)}),l.querySelector(".email__input").addEventListener("dblclick",function(e){return e.preventDefault()}),l.querySelector(".email__delete").addEventListener("click",function(e){return t.removeEmail(e)}),this.innerBoxEl.insertBefore(l,this.emailAddEl),this.isSubscribe&&this.emailListProxy.push(a),e&&(e.target.value="")):e.target.value=""}}}]),e}(),EmailsEditor=function(e){if(_instanceof(e,HTMLElement)&&1===e.nodeType)return new EmailsEditorApp(e);console.error("Provide HTMLElement node to render EmailsEditor")};
